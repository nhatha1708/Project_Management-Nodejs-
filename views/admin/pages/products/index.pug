extend ../../layout/default.pug
include ../../mixins/filter-status.pug
include ../../mixins/search.pug
include ../../mixins/pagination.pug

block main 
    h1 Product List
    +search(keyword)
    h5.mb-2 Bộ lọc trạng thái:
    div.d-flex.align-items-center.gap-3
        +filter-status(filterStatus)

    form(
        action=`${prefixAdmin}/products/change-multi?_method=PATCH`
        method="POST"
        form-change-multi
        class="form-change-multi"
    )
        select.form-select(name="type")
            option(value="active") Active
            option(value="inactive") Inactive

        input.form-control.d-none(
            type="text"
            name="ids"
            placeholder="Enter product IDs"
        )

        button.btn.btn-primary(type="submit") Apply
    table(
        class="product-table"
        checkbox-multi
    )
        thead
            tr
                th 
                  input(
                    type="checkbox"
                    name="check-all")
                th ID
                th Image
                th Name
                th Price
                th Category
                th Status
                th Actions
        tbody
            each product, index in products
                tr  
                    td 
                        input(
                            type="checkbox"
                            name="id"
                            value=product._id
                        )
                    - const currentPage = Number(pagination.currentPage);
                    - const limitItem = Number(pagination.limitItem);
                    td #{index + 1 + (currentPage - 1) * limitItem}
                    td
                        img(src=product.thumbnail, alt=product.title, class="product-image")
                    td #{product.title}
                    td #{product.price} $
                    td #{product.category}
                    td
                        if (product.status == 'active')
                            a(
                                href="javascript:;"
                                data-status=product.status
                                data-id=product._id
                                button-change-status
                                class="status available"
                                ) Active
                        else
                            a(
                                href="javascript:;"
                                data-status=product.status 
                                data-id=product._id
                                button-change-status
                                class="status out-of-stock"
                                ) Inactive
                    td
                        button.btn.btn-edit Edit
                        button.btn.btn-delete Delete

    +pagination(pagination)

    form(
        id="form-change-status"
        action=""
        method="POST"
        data-path=`${prefixAdmin}/products/change-status`
    )
    
    script(src="/admin/js/product.js")